---
layout: post
title: 提交历史神秘消失事件薄
date: 2017-02-06 10:57:14
description: 文件提交历史消失了？是 git 的 bug 还是被强行 reset 了？
categories: tech
---

## 代码被覆盖

老司机最怕的是什么？

老司机最怕的就是在新手面前装逼失败,比如说我刚刚向新人传授一系列确保不覆盖别人的代码的方法,转过头就有新人(将他称为 A)反映我覆盖了他的代码。

覆盖别人代码这种事,我已经很久没做过了。所以当听到这个消息时，我半信半疑。仔细的看过他给我展示的代码后,发觉确实是被覆盖了。在查看的文件的提交历史时,发现文件的提交历史只有寥寥几次,我的提交历史消失了,更难以置信的是, A 的提交历史一个都没有。

这真是一件很有意思的事情,但是当务之急是证明代码不是我覆盖的。

我清楚记得自己在那个文件添加过几行代码,如今也都不见了,实际上我也是受害者啊。

没有了文件的提交历史，只好查看开发分支上面所有的提交历史。找到 A 那些被覆盖的代码最初引进来的提交,以及最新提交,把两个提交之间的所有提交都按顺序仔细看一遍。

A 说是我覆盖了代码，是因为他在其中一个提交里看到我删除了他的代码。我并没有这样做过，但面对清清楚楚的代码，又无从辩白，只好在众人鄙视的眼光下默默地寻找真相。

这些提交都出自两个人,一个是我,另外一个暂且称他为 B 。我的代码也被覆盖了,所以推测覆盖代码的人肯定就是 B 。

平时很少用查看代码提交历史的工具（ stash ），花上不少时间后我终于找到证据， B 在一次合并操作当中 把我和 A 的代码都覆盖了。

事情就此告一段落，过了一个多月，直到最近看到这篇文章[《从GITLAB误删除数据库想到的》](http://coolshell.cn/articles/17680.html){:target="_blank"}，Gitlab 员工误删数据库非但不跑路，还在网上记录犯错的详细过程，这种追根究底的精神感动了我，忽然回想起文件提交历史神秘消失的事情。

## 神秘的提交历史消失
## git log 隐藏行为